<html lang='pt-br'>

<head>
    <meta charset='utf-8' />
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.18/index.global.min.js'></script>
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css' rel='stylesheet'>
    <link href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css' rel='stylesheet'>
    <script>
document.addEventListener('DOMContentLoaded', function () {
    let url = "http://localhost:5000/datas"
    var calendarEl = document.getElementById('calendar');

    // Cria o calendário uma única vez
    var calendar = new FullCalendar.Calendar(calendarEl, {
        themeSystem: 'bootstrap5',
        height: 400,
        headerToolbar: { center: 'dayGridMonth,timeGridWeek' },
        views: {
            dayGridMonth: {
                titleFormat: { day: '2-digit', month: '2-digit', year: 'numeric' }
            }
        },
        timeZone: 'UTC−03:00',
        initialView: 'dayGridMonth',
        locale: 'pt-br'
    });

    calendar.render();

    let obj = new XMLHttpRequest();
    obj.open("GET", url, true);
    obj.onreadystatechange = function () {
        if (obj.readyState == 4 && obj.status == 200) {
            var resposta = JSON.parse(obj.responseText);
            console.log(resposta);

            // Use for...of para iterar sobre objetos
            for (let NovoEvento of resposta) {
                calendar.addEvent({
                    title: NovoEvento.title,
                    start: NovoEvento.start,
                });
            }
        }
    };
    obj.send();
});
</script>

</head>

<body>
    <div id='calendar'></div>
</body>

</html>